---

- name: Install required packages
  become: yes
  apt:
    name:
      - cmake
      - pkg-config
      - libfreetype6-dev
      - libfontconfig1-dev
      - libxcb-xfixes0-dev
      - libxkbcommon-dev
      - python3
    state: present
    update_cache: yes

- name: Install Rust programming language
  shell: curl https://sh.rustup.rs -sSf | sh -s -- -y
  args:
    creates: $HOME/.cargo/bin/rustc

- name: Clone Alacritty repository
  git:
    repo: 'https://github.com/alacritty/alacritty.git'
    dest: "~/alacritty"
    version: master
    clone: yes
    update: yes

- name: Compile Alacritty
  shell: ~/.cargo/bin/cargo build --release
  args:
    chdir: "~/alacritty"

- name: Install Alacritty
  become: yes
  shell: |
    cp ~/alacritty/target/release/alacritty /usr/local/bin
    cp ~/alacritty/extra/logo/alacritty-term.svg /usr/share/pixmaps/Alacritty.svg
    desktop-file-install ~/alacritty/extra/linux/Alacritty.desktop
    update-desktop-database
  args:
    chdir: "~/alacritty"
